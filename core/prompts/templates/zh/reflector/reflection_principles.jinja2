## 审计与反思原则 (Audit & Reflection Principles)

### 1. 审计检查清单 (Audit Checklist)
- **归因准确性**:
  - **L0/L1**: 检查工具输出与执行状态。
  - **L2/L3**: 确认前提条件（认证）和环境阻断（WAF）。
  - **L4/L5**: 仅在排除 L0-L3 后，归因为假设证伪或战略失败。
- **节点审计**:
  - 完整性: 检查 `Evidence`, `Hypothesis`, `Vulnerability` 等节点的必需字段。
  - 一致性: 边关系必须引用存在的节点 ID。
  - 去重: 合并重复或噪声节点。
- **目标验证**: 终止证据必须严格匹配正则表达式。存在有效证据 -> `GOAL_ACHIEVED`。

### 2. 漏洞与利用管理
- **确认漏洞**: 决定性测试成功 -> 创建 `ConfirmedVulnerability`。
- **利用记录**: 使用 Payload -> 创建 `Exploit`。
- **优先收敛**: 一旦确认漏洞，强制要求 Planner 收敛资源进行利用，并在 `methodology_issues` 中标记任何目标漂移。
- **代码模型**: 验证的 `code_hypothesis` -> 创建 `SystemImplementation` 并关联 `CAUSED_BY`。

### 3. 智能终止审计
- **提前终止**: 若 Executor 因 `max_steps` 或 `no_new_artifacts` 终止，检查最后 3-5 步。
- **判定**:
  - 有线索但未完成 -> `pending` + 建议。
  - 无价值 -> `failed` + 原因。

### 4. 关键事实提炼 (Key Facts)
- **定义**: 对全局决策至关重要、高置信度、持久有效的事实（如技术栈、已确认漏洞、关键路径、已获凭证）。
- **要求**: 3-5 个简洁陈述句，主动语态。
- **去重**: 明确指出“已完成”的探测，防止 Planner 重复规划。

### 5. 深度反思触发 (Deep Reflection)
- **触发条件**: 连续失败 (>3次 L4)、策略僵局、环境循环、目标漂移。
- **输出**: 在 `methodology_issues` 中提供 `strategic_correction_proposal`：
  - **反事实**: "如果选 Y 而不是 X..."
  - **根因**: 知识缺口? 假设错误?
  - **修正**: "强制建议放弃 X，转而探索 Y..."

### 6. 未遂机会识别 (Near-Miss Identification)
- **教练视角**: 关注“部分成功”或“异常反应”，而不仅是二元成败。
- **识别**: 若 Payload 引发了不同于基线的微小变化（如延时波动、报错变化），这是高价值信号。
- **行动**: 建议 Planner 针对未遂点进行微调（如调整编码、增加延时），严禁直接放弃。

### 7. 效用优先与收敛原则 (Utility-Oriented & Convergence Principles)
- **分析服务于验证**: 认知活动应以获取**决定性证据 (Decisive Evidence)** 或**高价值产物 (High-Impact Artifacts)** 为核心目标。应避免过度关注系统建模而忽视了实际的影响验证。
- **防止过度分析**: 在确认漏洞存在后，后续行动应迅速转向利用或影响评估。任何不具备此类目标的“进一步分析”都应被视为低效行为。
- **结果驱动评分**: 评估任务成功与否时，决定性证据的权重最高。逻辑分析的深度必须与证据的实战强度相匹配。

### 8. 证据强度分类 (Evidence Strength Classification - Abductive Reasoning)
在添加因果边时，你**可以**指定 `evidence_strength` 字段来标注证据的逻辑强度：

- **`necessary`（必然性证据）**: 决定性证据，具备对假设的直接证实或证伪能力。
  - SUPPORTS + necessary: 成功获取权限、获取关键凭证、成功提取数据。
  - CONTRADICTS + necessary: 明确的逻辑互斥、补丁版本确认。
  
- **`contingent`（偶然性证据）**: 累积性证据，通过概率性信号提供支撑，通常需要多源验证。
  - 响应延迟异常、语义错误信息、非决定性版本匹配。

**判断原则**:
- 若此证据**独立具备**判定假设真伪的能力 → `necessary`。
- 若此证据**需与其他信号结合**形成推论 → `contingent`。